<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Vehicle Report</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>
  <div class="vehicle-details-container">
    <!-- Enhanced Header Section -->
    <div class="header-section">
      <div class="header-content">
        <div class="header-icon">
          <i class="fas fa-flask"></i>
        </div>
        <h2>Test Vehicle Report</h2>
        <div class="header-subtitle">
          <span>Vehicle Testing & QA Analytics</span>
        </div>
      </div>
      <!-- <div class="header-stats" *ngIf="!isLoading && totalTestVehicles > 0">
        <div class="stat-card">
          <div class="stat-number">{{totalTestVehicles}}</div>
          <div class="stat-label">Test Vehicles</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{{getActiveTestsCount()}}</div>
          <div class="stat-label">Active Tests</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">{{getUniqueCount('testType')}}</div>
          <div class="stat-label">Test Types</div>
        </div>
      </div> -->
    </div>

    <!-- Enhanced Filter Section -->
    <!-- <div class="filter-section">
      <div class="filter-header">
        <div class="filter-title">
          <i class="fas fa-filter"></i>
          <span>Test Vehicle Filters</span>
        </div>
      </div>
      
      <div class="filter-content compact">
        <div class="filter-row compact-row">
          <mat-form-field appearance="outline" class="filter-field mini">
            <mat-label>
              <mat-icon class="filter-icon">event</mat-icon>
              <span class="visually-hidden">Test Start Date</span>
            </mat-label>
            <input matInput [matDatepicker]="startPicker" [(ngModel)]="testStartDate" (dateChange)="onFilterChange()" placeholder="Test Start">
            <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
            <mat-datepicker #startPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" class="filter-field mini">
            <mat-label>
              <mat-icon class="filter-icon">event</mat-icon>
              <span class="visually-hidden">Test End Date</span>
            </mat-label>
            <input matInput [matDatepicker]="endPicker" [(ngModel)]="testEndDate" (dateChange)="onFilterChange()" placeholder="Test End">
            <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
            <mat-datepicker #endPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline" class="filter-field mini">
            <mat-label>
              <mat-icon class="filter-icon">science</mat-icon>
              <span class="visually-hidden">Test Type</span>
            </mat-label>
            <mat-select [(ngModel)]="testType" (selectionChange)="onFilterChange()">
              <mat-option value="">All Test Types</mat-option>
              <mat-option value="Performance">Performance Test</mat-option>
              <mat-option value="Safety">Safety Test</mat-option>
              <mat-option value="Durability">Durability Test</mat-option>
              <mat-option value="Emissions">Emissions Test</mat-option>
              <mat-option value="Fuel Economy">Fuel Economy Test</mat-option>
              <mat-option value="QA">Quality Assurance</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="filter-field mini">
            <mat-label>
              <mat-icon class="filter-icon">assignment</mat-icon>
              <span class="visually-hidden">Test Status</span>
            </mat-label>
            <mat-select [(ngModel)]="testStatus" (selectionChange)="onFilterChange()">
              <mat-option value="">All Status</mat-option>
              <mat-option value="In Progress">In Progress</mat-option>
              <mat-option value="Completed">Completed</mat-option>
              <mat-option value="On Hold">On Hold</mat-option>
              <mat-option value="Failed">Failed</mat-option>
              <mat-option value="Passed">Passed</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="filter-field mini">
            <mat-label>
              <mat-icon class="filter-icon">directions_car</mat-icon>
              <span class="visually-hidden">Vehicle Make</span>
            </mat-label>
            <input matInput [(ngModel)]="vehicleMake" placeholder="Vehicle Make" (input)="onFilterChange()">
          </mat-form-field>

          <mat-form-field appearance="outline" class="filter-field mini">
            <mat-label>
              <mat-icon class="filter-icon">person</mat-icon>
              <span class="visually-hidden">Test Engineer</span>
            </mat-label>
            <input matInput [(ngModel)]="testEngineer" placeholder="Test Engineer" (input)="onFilterChange()">
          </mat-form-field>

          <div class="filter-actions compact-actions" style="display: flex; gap: 10px; align-items: center;">
            <button mat-raised-button color="primary"
                    (click)="applyFilters()"
                    [disabled]="isLoading"
                    class="apply-btn"
                    [attr.aria-label]="isLoading ? 'Loading' : 'Apply Filters'"
                    style="display: flex; align-items: center; gap: 6px; font-weight: 600; box-shadow: 0 2px 8px rgba(33,147,176,0.10); border-radius: 6px; padding: 0 16px;">
              <mat-icon *ngIf="!isLoading" style="font-size: 1.2rem;">filter_alt</mat-icon>
              <mat-icon *ngIf="isLoading" class="spin" style="font-size: 1.2rem; animation: spin 1s linear infinite;">sync</mat-icon>
              <span *ngIf="!isLoading">Apply</span>
              <span *ngIf="isLoading">Loading...</span>
            </button>
            <button mat-stroked-button
                    (click)="clearFilters()"
                    class="clear-btn"
                    aria-label="Clear"
                    color="warn"
                    style="display: flex; align-items: center; gap: 6px; font-weight: 600; border-radius: 6px; padding: 0 16px;">
              <mat-icon style="font-size: 1.1rem;">clear</mat-icon>
              <span>Clear</span>
            </button>
          </div>
        </div>
      </div>
    </div> -->

    <!-- Loading State -->
    <div class="loading-container" *ngIf="isLoading">
      <div class="loading-spinner">
        <div class="spinner"></div>
      </div>
      <div class="loading-text">Loading test vehicle data...</div>
    </div>

    <!-- Enhanced Table Container -->
    <div class="table-container" *ngIf="!isLoading">
      <div class="table-header">
        <div class="table-title">
          <i class="fas fa-table"></i>
          <span>Test Vehicle Data</span>
        </div>
        <div class="table-actions">
          <button mat-stroked-button (click)="exportData('csv')" class="export-btn">
            <i class="fas fa-download"></i>
            <span>Export CSV</span>
          </button>
          <!-- <button mat-stroked-button (click)="generateTestReport()" class="export-btn">
            <i class="fas fa-file-alt"></i>
            <span>Test Report</span>
          </button> -->
        </div>
      </div>
      
      <div class="responsive-table">
        <table mat-table [dataSource]="dataSource" matSort #sort class="enhanced-table">
          <!-- Enhanced column definitions -->
          <ng-container *ngFor="let column of displayedColumns" [matColumnDef]="column">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="enhanced-header"> 
              <div class="header-content">
                <span>{{ getColumnHeader(column) }}</span>
                <i class="fas fa-sort" *ngIf="column !== 'actions'"></i>
              </div>
            </th>
            <td mat-cell *matCellDef="let item" [class.truncate]="shouldTruncate(column)" class="enhanced-cell">
              <div class="cell-content">
                <span *ngIf="column === 'testStatus'" 
                      class="status-badge"
                      [class.active]="item.testStatus === 'Passed' || item.testStatus === 'Completed'"
                      [class.in-progress]="item.testStatus === 'In Progress'"
                      [class.failed]="item.testStatus === 'Failed'"
                      [class.on-hold]="item.testStatus === 'On Hold'">
                  {{ item.testStatus }}
                </span>
                <span *ngIf="column !== 'testStatus'">{{ getColumnValue(item, column) }}</span>
              </div>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="enhanced-row"></tr>
          
          <!-- No data state -->
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell no-data-cell" [attr.colspan]="displayedColumns.length">
              <div class="no-data-content">
                <i class="fas fa-search"></i>
                <span>No test vehicles found matching the selected criteria</span>
              </div>
            </td>
          </tr>
        </table>
      </div>
    
      <mat-paginator 
        #paginator
        [pageSizeOptions]="[5, 10, 25, 50]"
        [pageSize]="10"
        [length]="totalTestVehicles"
        showFirstLastButtons
        aria-label="Select page of test vehicles"
        class="enhanced-paginator">
      </mat-paginator>
    </div>
  </div>
</body>
</html> 